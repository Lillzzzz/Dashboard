step,timestamp,action,source,target,description,rows_before,rows_after,rows_removed,extra_info
1,2026-01-10T16:06:40.500064Z,load,charts.csv,charts,Initiales Laden der Spotify Charts-Daten mit allen verfügbaren Zeilen und Spalten.,,26173514,,
2,2026-01-10T16:06:45.197098Z,load,Final database.csv,final_db,Laden der finalen Datenbank mit ergänzenden Track-Informationen und Metadaten.,,170633,,
3,2026-01-10T16:06:45.701931Z,load,dataset.csv,dataset,"Laden des Spotify-Datasets mit Audio-Features (Danceability, Energy, etc.).",,114000,,
4,2026-01-10T16:06:46.290656Z,filter,charts,charts,"Filterung auf definierte Märkte: Germany, United Kingdom, Brazil. Nur Datensätze aus diesen Regionen werden beibehalten.",26173514,1353341,24820173,"Filter: region in ['Germany', 'United Kingdom', 'Brazil']"
5,2026-01-10T16:06:46.677456Z,filter,charts,charts,Zeitliche Filterung auf Analysezeitraum 2017-2021. Frühere und spätere Daten werden ausgeschlossen.,1353341,1353341,0,Filter: year between 2017 and 2021
6,2026-01-10T16:06:48.333505Z,feature_engineering,charts,charts,Extraktion der Track-ID aus Spotify-URL via Regex. Ermöglicht eindeutige Track-Identifikation über Datasets hinweg.,1353341,1353341,0,Pattern: track/([A-Za-z0-9]+)
7,2026-01-10T16:06:49.123305Z,drop_duplicates,charts,charts,"Entfernung exakter Duplikate basierend auf Track-ID, Datum und Markt. Sichert eindeutige Chart-Einträge pro Tag/Markt.",1353341,1252756,100585,"Keys: track_id, date, market"
8,2026-01-10T16:06:51.012834Z,imputation,charts,charts,Imputation fehlender Stream-Werte mit Median pro Jahr und Markt. Erhält Datenqualität ohne Verzerrung der Statistiken.,1252756,1252756,0,Method: Median imputation grouped by year × market
9,2026-01-10T16:06:51.596397Z,clean_nulls,charts,charts,Finale Bereinigung: Entfernung von Datensätzen mit fehlenden essentiellen Feldern und Streams <= 0.,1252756,1252756,0,Dropped: track_id/date/market is NULL OR streams <= 0
10,2026-01-10T16:06:52.913078Z,clean_nulls,final_db,audio_df,Extraktion relevanter Audio-Features und Metadaten. Entfernung von Tracks ohne Track-ID und Deduplizierung.,170633,62419,108214,"Columns: track_id, audio_features, metadata"
11,2026-01-10T16:06:53.386802Z,clean_numeric,audio_df,audio_df,"Bereinigung und Clipping der Audio-Features auf plausible Wertebereiche. Tempo: 30-250 BPM, andere Features: 0-1.",62419,62419,0,"Tempo: 30-250 BPM, Audio features: 0-1, Popularity: 0-100"
12,2026-01-10T16:06:53.538307Z,harmonize,hardcoded mapping,genre_df,Genre-Harmonisierung über Mapping. Konsolidiert 49 Detail-Genres in Hauptkategorien für konsistente Analyse.,62419,62419,0,Mapping categories: 8 unique genres
13,2026-01-10T16:06:54.303248Z,merge,charts + audio_df,merged,Zusammenführung von Charts und Audio-Features via Track-ID. Ergänzt Audio-Charakteristiken und Artist Followers.,1252756,1252756,0,Join: charts.track_id = audio_df.track_id (left join)
14,2026-01-10T16:06:55.179343Z,merge,merged + genre_df,merged,Anreicherung mit harmonisierten Genre-Informationen. Ermöglicht Genre-basierte Analysen.,1252756,1252756,0,Join: merged.track_id = genre_df.track_id (left join)
15,2026-01-10T16:06:56.318535Z,feature_engineering,merged,merged,"Berechnung des Success-Scores (0-100) aus Chart-Rank (25%), Streams (15%), Audio-Features (30%), Followers (20%) und Top-Placements (10%).",1252756,1252756,0,"Formula: weighted composite score, threshold: ≥65"
16,2026-01-10T16:07:18.696004Z,aggregate,merged,kpi_df,"Aggregation zu KPI-Metriken pro Genre, Jahr und Markt. Berechnet Marktanteile, Shannon-Diversität, Success-Rates und Growth-Momentum.",,128,,Grouping: year × market × genre_harmonized
17,2026-01-10T16:07:18.920135Z,aggregate,merged,market_trends,Berechnung von Markt-Trends über Zeit. Zeigt relative Marktanteile (%) der drei Regionen pro Jahr.,,15,,Grouping: year × market
18,2026-01-10T16:07:19.469215Z,filter,merged,recent_data,"Filterung auf die letzten zwei Jahre (2020, 2021) zur Identifikation aktueller High-Potential Tracks.",1252756,495752,757004,"Filter: year in [2020, 2021]"
19,2026-01-10T16:07:19.738645Z,filter,recent_data,high_potential,Aggregation und Filterung auf High-Potential Tracks. Mindestens 1000 Streams erforderlich für Relevanz.,14490,14490,0,Filter: total_streams >= 1000
20,2026-01-10T16:07:19.791234Z,export,DataFrame,cleaned_charts_kpi.csv,Export der bereinigten und aggregierten Daten. Datei enthält 128 Zeilen und 11 Spalten für Dashboard-Nutzung.,,128,,"Format: CSV (UTF-8 with BOM), Columns: 11"
21,2026-01-10T16:07:46.403461Z,export,DataFrame,spotify_charts_enhanced.csv,Export der bereinigten und aggregierten Daten. Datei enthält 1252756 Zeilen und 27 Spalten für Dashboard-Nutzung.,,1252756,,"Format: CSV (UTF-8 with BOM), Columns: 27"
22,2026-01-10T16:07:46.601819Z,export,DataFrame,high_potential_tracks.csv,Export der bereinigten und aggregierten Daten. Datei enthält 14490 Zeilen und 12 Spalten für Dashboard-Nutzung.,,14490,,"Format: CSV (UTF-8 with BOM), Columns: 12"
23,2026-01-10T16:07:46.606032Z,export,DataFrame,cleaned_market_trends.csv,Export der bereinigten und aggregierten Daten. Datei enthält 15 Zeilen und 4 Spalten für Dashboard-Nutzung.,,15,,"Format: CSV (UTF-8 with BOM), Columns: 4"
