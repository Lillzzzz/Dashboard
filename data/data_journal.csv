step,timestamp,action,source,target,description,rows_before,rows_after,rows_removed,extra_info
1,2026-01-21T15:48:49.034712Z,load,charts.csv,charts,Initiales Laden der Spotify Charts-Daten mit allen verfügbaren Zeilen und Spalten.,,26173514,,
2,2026-01-21T15:48:59.376554Z,filter,charts,charts,"Filterung auf definierte Märkte: Germany, United Kingdom, Brazil. Nur Datensätze aus diesen Regionen werden beibehalten.",26173514,1353341,24820173,"Filter: region in ['Germany', 'United Kingdom', 'Brazil']"
3,2026-01-21T15:48:59.695866Z,filter,charts,charts,Zeitliche Filterung auf Analysezeitraum 2017-2021. Frühere und spätere Daten werden ausgeschlossen.,1353341,1353341,0,Filter: year between 2017 and 2021
4,2026-01-21T15:49:00.813359Z,feature_engineering,charts,charts,"Track-ID aus der Spotify-URL gezogen (Regex), für sauberes mergen.",1353341,1353341,0,Pattern: track/([A-Za-z0-9]+)
5,2026-01-21T15:49:01.929073Z,drop_duplicates,charts,charts,"Entfernung exakter Duplikate basierend auf Track-ID, Datum und Markt. Sichert eindeutige Chart-Einträge pro Tag/Markt.",1353341,1252756,100585,"Keys: track_id, date, market"
6,2026-01-21T15:49:03.231950Z,imputation,charts,charts,Fehlende Streams: Median je Jahr×Markt eingesetzt (einfacher Fallback).,1252756,1252756,0,Method: Median imputation grouped by year × market
7,2026-01-21T15:49:03.738785Z,clean_nulls,charts,charts,Finale Bereinigung: Entfernung von Datensätzen mit fehlenden essentiellen Feldern und Streams <= 0.,1252756,1252756,0,Dropped: track_id/date/market is NULL OR streams <= 0
8,2026-01-21T15:49:11.345628Z,load,Final database.csv,final_db,Laden der finalen Datenbank mit ergänzenden Track-Informationen und Metadaten.,,170633,,
9,2026-01-21T15:49:12.110365Z,load,dataset.csv,dataset,"Laden des Spotify-Datasets mit Audio-Features (Danceability, Energy, etc.).",,114000,,
10,2026-01-21T15:49:12.576168Z,clean_nulls,final_db,audio_df,Extraktion relevanter Audio-Features und Metadaten. Entfernung von Tracks ohne Track-ID und Deduplizierung.,170633,62419,108214,"Columns: track_id, audio_features, metadata"
11,2026-01-21T15:49:12.880389Z,clean_numeric,audio_df,audio_df,"Audio-Features in sinnvolle Bereiche gekappt (0–1, Tempo 30–250).",62419,62419,0,"Tempo: 30-250 BPM, Audio features: 0-1, Popularity: 0-100"
12,2026-01-21T15:49:13.102497Z,harmonize,hardcoded mapping,genre_df,Genre-Harmonisierung über Mapping. Konsolidiert 49 Detail-Genres in Hauptkategorien für konsistente Analyse.,62419,62419,0,Mapping categories: 8 unique genres | Other-Rate: 24.9%
13,2026-01-21T15:49:13.893944Z,merge,charts + audio_df,merged,Zusammenführung von Charts und Audio-Features via Track-ID. Ergänzt Audio-Charakteristiken und Artist Followers.,1252756,1252756,0,Join: charts.track_id = audio_df.track_id (left join) | Coverage: 100.0%
14,2026-01-21T15:49:14.707927Z,merge,merged + genre_df,merged,Anreicherung mit harmonisierten Genre-Informationen. Ermöglicht Genre-basierte Analysen.,1252756,1252756,0,Join: merged.track_id = genre_df.track_id (left join) | Genre-Coverage: 65.0% | Other-Rate: 12.2%
15,2026-01-21T15:49:15.779257Z,feature_engineering,merged,merged,"Berechnung des Success-Scores (0-100) aus Chart-Rank (25%), Streams (15%), Audio-Features (30%), Followers (20%) und Top-Placements (10%).",1252756,1252756,0,"Formula: weighted composite score, threshold: ≥65"
16,2026-01-21T15:49:36.395200Z,aggregate,merged,kpi_df,"Aggregation zu KPI-Metriken pro Genre, Jahr und Markt. Berechnet Marktanteile, Shannon-Diversität, Success-Rates und Growth-Momentum.",,128,,Grouping: year × market × genre_harmonized | Market Potential: normalized growth (capped at 200)
17,2026-01-21T15:49:36.549364Z,aggregate,merged,market_trends,Berechnung von Markt-Trends über Zeit. Zeigt relative Marktanteile (%) der drei Regionen pro Jahr.,,15,,Grouping: year × market
18,2026-01-21T15:49:36.870139Z,filter,merged,recent_data,"Filterung auf die letzten zwei Jahre (2020, 2021) zur Identifikation aktueller High-Potential Tracks.",1252756,495752,757004,"Filter: year in [2020, 2021]"
19,2026-01-21T15:49:37.106891Z,filter,recent_data,high_potential,Aggregation und Filterung auf High-Potential Tracks. Mindestens 1000 Streams erforderlich für Relevanz.,14490,14490,0,Filter: total_streams >= 1000
20,2026-01-21T15:49:37.146734Z,export,DataFrame,cleaned_charts_kpi.csv,Export der bereinigten und aggregierten Daten. Datei enthält 128 Zeilen und 11 Spalten für Dashboard-Nutzung.,,128,,"Format: CSV (UTF-8 with BOM), Columns: 11"
21,2026-01-21T15:52:05.601814Z,export,DataFrame,spotify_charts_enhanced.csv,Export der bereinigten und aggregierten Daten. Datei enthält 1252756 Zeilen und 27 Spalten für Dashboard-Nutzung.,,1252756,,"Format: CSV (UTF-8 with BOM), Columns: 27"
22,2026-01-21T15:52:05.898600Z,export,DataFrame,high_potential_tracks.csv,Export der bereinigten und aggregierten Daten. Datei enthält 14490 Zeilen und 12 Spalten für Dashboard-Nutzung.,,14490,,"Format: CSV (UTF-8 with BOM), Columns: 12"
23,2026-01-21T15:52:05.903596Z,export,DataFrame,cleaned_market_trends.csv,Export der bereinigten und aggregierten Daten. Datei enthält 15 Zeilen und 4 Spalten für Dashboard-Nutzung.,,15,,"Format: CSV (UTF-8 with BOM), Columns: 4"
